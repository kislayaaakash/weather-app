version: "3.8"
services:
  backend:
    image: ${BACKEND_IMAGE} # Dynamically set from Jenkins pipeline
    container_name: spring-boot-app-2
    ports:
      - "8080:8080" # Map backend container port to host port
    volumes:
      - weather-cache-volume:/app
    networks:
      - weather-app-network # Add service to custom network
    environment:
      WEATHER_API_KEY: ${WEATHER_API_KEY}
      WEATHER_API_COUNT: ${WEATHER_API_COUNT}
      WEATHER_API_SERVICE_TYPE: ${WEATHER_API_SERVICE_TYPE}
      SERVICE_ONLINE: ${SERVICE_ONLINE}
      SERVICE_CACHE_FILE_NAME: ${SERVICE_CACHE_FILE_NAME}
      SERVICE_UPDATE_BACKUP_DURATION_THRESHOLD: ${SERVICE_UPDATE_BACKUP_DURATION_THRESHOLD}

volumes:
  weather-cache-volume: # Volume for backend data persistence

networks:
  weather-app-network:
    driver: bridge # Explicitly defining a custom bridge network
